var assert = require("assert") ;

exports.buildControllerResponse = function(httpRspn){

	if( httpRspn._isControllerResponse )
	{
		return ;
	}

	httpRspn._isControllerResponse = true ;
	httpRspn._locks = 0 ;

	httpRspn.pause = function()
	{
		httpRspn._locks ++ ;
	}
	httpRspn.resume = function()
	{
		assert(httpRspn._locks>=1,"httpRspn._locks must be >0") ;

		if( (--httpRspn._locks)<=0 )
		{
			this.emit("complete") ;
		}
	}

	httpRspn._oriEnd = httpRspn.end ;
	httpRspn.end = function()
	{
		this._oriEnd() ;
	}

	return httpRspn ;

}